<!doctype html><html><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Notes</title><meta name=apple-mobile-web-app-title content="Notes"><link rel=stylesheet href=/main.css></head><body><main class=index><article><a href=/>back</a><header><h1>Elisp function to run Golang unit tests <small>in notes</small></h1><small>2022-03-02</small></header><p>A elisp function to run a unit test. Put the function in ~/.emacs</p><figure><div class="src src-elisp"><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-elisp data-lang=elisp><span style=display:flex><span>  (defun go-run-unit-test ()
</span></span><span style=display:flex><span>    (interactive)
</span></span><span style=display:flex><span>    (let ((lineStr <span style=color:#e6db74>&#34;&#34;</span>))
</span></span><span style=display:flex><span>(if (string= (thing-at-point <span style=color:#e6db74>&#39;word</span>) <span style=color:#e6db74>&#34;func&#34;</span>)
</span></span><span style=display:flex><span>   (setq lineStr (thing-at-point <span style=color:#e6db74>&#39;word</span>))
</span></span><span style=display:flex><span> (progn
</span></span><span style=display:flex><span>   (<span style=color:#a6e22e>search-backward</span> <span style=color:#e6db74>&#34;func&#34;</span>)
</span></span><span style=display:flex><span>   (setq lineStr (thing-at-point <span style=color:#e6db74>&#39;line</span>))))
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>(let ((funcName (string-trim-left (<span style=color:#a6e22e>car</span> (split-string (thing-at-point <span style=color:#e6db74>&#39;line</span>) <span style=color:#e6db74>&#34;(&#34;</span>)) <span style=color:#e6db74>&#34;^func\s&#34;</span>)))
</span></span><span style=display:flex><span> (<span style=color:#a6e22e>start-process</span> <span style=color:#e6db74>&#34;GOTEST&#34;</span> <span style=color:#e6db74>&#34;*GOTEST*&#34;</span> <span style=color:#e6db74>&#34;go&#34;</span> <span style=color:#e6db74>&#34;test&#34;</span> <span style=color:#e6db74>&#34;-run&#34;</span> (<span style=color:#a6e22e>concat</span> <span style=color:#e6db74>&#34;^&#34;</span> funcName <span style=color:#e6db74>&#34;$&#34;</span>)))))</span></span></code></pre></div></div><figcaption>go-run-unit-test</figcaption></figure></article></main></body></html>